---
title: "Análisis comparativo de la relación calidad-precio en vehículos por tipo de
  motorización: eléctrico, híbrido y de combustible en el mercado global 2025"
author: "Angel Pastrano y Valeria Barreto"
date: "2025-10-16"
output:
   html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    collapsed: true
    smooth_scroll: true
    theme: journal
    highlight: kate
    df_print: paged
    code_folding: hide
---
```{r load_data, include=FALSE}
# ruta para que funcione desde posit y RStudio
library(readr)
library(here)
ruta <- here("data", "Cars Datasets 2025.csv")
data_carros <- read.csv(ruta)
```

```{r librerias, include=FALSE}
library(dplyr)
library(stringr)
library(ggplot2)
library(here)
```
# **Introducción**


# **Planteamiento del problema**

La industria automotriz está en una transición. Los vehículos eléctricos e híbridos han crecido en popularidad, pero a menudo se perciben como opciones más caras. Esta percepción plantea una pregunta crítica para los consumidores: ¿Cuál de las tres principales tecnologías de motorización _(eléctrico, híbrido o de combustible fósil)_ ofrece la mejor relación calidad-precio, considerando el rendimiento del motor frente a su costo de compra inicial?

## **Objetivo general**

Determinar la categoría de motorización (eléctrica, híbrida o combustible fósil) que presenta la mejor relación calidad-precio en el mercado automotriz, basándose en un análisis descriptivo de las características del "cars dataset 2025"

## **Objetivos específicos**

1. Clasificar los vehículos del dataset en tres grupos: Eléctrico, Híbrido y Combustible Fósil _(Gasolina/Diésel)_.

2. Calcular y comparar los estadísticos descriptivos _(media, mediana, desviación estándar)_ para el precio y el índice de calidad-precio en cada una de las tres categorías.

3. Identificar y reportar la categoría de motorización que obtiene el valor medio más alto en el índice de calidad-precio.

# **Marco de referencia** 

## **Marco teórico**

El análisis descriptivo se fundamenta en la hipótesis de que la eficiencia de costo por unidad de potencia **RCP** variará significativamente entre las tres categorías de motorización. Se espera que los vehículos con tecnología más establecida _(Combustible Fósil)_ puedan ofrecer un **RCP** alto debido a los menores costos de producción en comparación con las tecnologías de baterías _(Híbridos y Eléctricos)_, aunque el estudio busca identificar el grupo con el valor medio de **RCP** más alto.

La Relación Calidad-Precio **(RCP)**, o Value for Money, es la métrica fundamental de este análisis. Se define operacionalmente como la razón entre la variable de rendimiento _(calidad)_ y el precio: 

Índice de calidad-precio = Horses Power/Cars Price$

Un valor más alto en este índice indica una mejor relación calidad-precio, ya que el vehículo ofrece mayor potencia _(calidad)_ por cada unidad de costo _(precio)_.

## **Marco metodológico**

### **Fuente de datos**

Se utiliza el conjunto de datos Cars_Datasets_2025.csv, que contiene registros de precio, marca, motorizacion y potencia _(Horses Power)_.

# ANALISIS POR SEGMENTOS

# TOP 10 MEJORES CARROS CALIDAD/PRECIO
Este es un ranking basado en el índice QPR (puntos de calidad por cada $1,000 USD), para asi encontrar a los vehículos con mayor eficiencia en calidad-precio del mercado.
A través de este estudio, identificamos no solo los vehículos con el mejor balance, sino que ademas aquellos cuyo alto precio no necesariamente se traduce en una superioridad en calidad, guiando tu decisión hacia la mejor desicion de compra.

Ahora bien, ¿cómo vamos a saber qué carro es más rentable que otro?
Los gustos personales y las percepciones de lo “superior” varían enormemente entre compradores. Por eso, para eliminar subjetividades y ofrecer una evaluación justa y comparable, desarrollamos una fórmula basada en datos técnicos que asigna puntos de calidad a cada vehículo.

La Fórmula es la siguiente: Puntos de Calidad = Potencia + Velocidad Máxima – (10 × Aceleración 0-100 km/h)

¿Por qué estos tres factores?
Porque representan, de forma sencilla y universal, el rendimiento básico de un auto:

Potencia (cv) y Velocidad Máxima (km/h):
A mayor potencia y velocidad, más capacidad de respuesta y desempeño.

Aceleración (segundos 0-100 km/h):
Un valor bajo en aceleración es mejor (menos tiempo = más rápido).
Por eso multiplicamos la aceleración por 10 y la restamos:

Un auto rápido (ej. 5 segundos) resta solo 50 puntos.

Un auto lento (ej. 12 segundos) resta 120 puntos.

Ejemplo:
Un auto con 150 cv, 200 km/h de velocidad máxima y aceleración de 8 segundos tendría:
Puntos de Calidad = 150 + 200 – (10 × 8) = 270 puntos

Paso 2: La Relación Calidad-Precio (QPR)

Pero no basta con saber cuánto rinde un auto, ¿Vale la pena pagar su precio?,
para responder esto, convertimos los Puntos de Calidad en rentabilidad real:

Fórmula QPR = (Puntos de Calidad ÷ Precio) × 1000

Esto nos dice:
¿Cuántos puntos de calidad obtienes por cada $1,000 USD que gastas?

Más alto el QPR = Más rendimiento por tu dinero.

Más bajo el QPR = Menos eficiencia en lo que pagas.
```{r TOP_10_QPR, echo=FALSE, warning=FALSE}
# Limpieza, Conversión y Cálculo
data_qpr <- data_carros %>%
  # Limpieza del Precio 
  mutate(
    # Quitar símbolos
    Price_Clean = str_replace_all(Cars.Prices, "[$, ]|approx", ""),
    
    # Manejar rangos: si hay '-', calcula el promedio; si no, agarra el valor
    Price_Avg = case_when(
      str_detect(Price_Clean, "-") ~ {
        prices <- str_split(Price_Clean, "-")[[1]]
        mean(as.numeric(prices), na.rm = TRUE)
      },
      TRUE ~ as.numeric(Price_Clean)
    )
  ) %>%
  # Limpieza del Rendimiento (Potencia, Velocidad, Aceleración)
  mutate(
    # Extraer solo el primer valor numérico de cada columna
    HP_Clean = as.numeric(str_extract(HorsePower, "^[0-9.]+")),
    Speed_Clean = as.numeric(str_extract(Total.Speed, "^[0-9.]+")),
    Accel_Clean = as.numeric(str_extract(Performance.0...100..KM.H, "^[0-9.]+|\\d"))
  ) %>%
  
  # Eliminar filas con valores faltantes después de la limpieza
  filter(!is.na(Price_Avg) & !is.na(HP_Clean) & !is.na(Speed_Clean) & !is.na(Accel_Clean) & Price_Avg > 0) %>%
  
  # Quality Index = HP + Speed - (10 * Acceleration)
  mutate(
    Quality_Index = HP_Clean + Speed_Clean - (10 * Accel_Clean)
  ) %>%
  

  # QPR = (Quality Index / Price_Avg) * 1000 (Puntos de Calidad por cada $1000 USD)
  mutate(
    QPR = (Quality_Index / Price_Avg) * 1000
  )

#  Clasificación y Top 10
top_10_qpr <- data_qpr %>%
  arrange(desc(QPR)) %>%
  select(Company.Names, Cars.Names, Fuel.Types, Price_Avg, Quality_Index, QPR) %>%
  head(10)

# Renombrar columnas 
names(top_10_qpr) <- c("Fabricante", "Modelo", "Motorización", "Precio Promedio (USD)", "Índice de Calidad", "Relación QPR (Puntos/1k USD)")

# mostramos el Top 10
print(top_10_qpr)
```


```{r TOP_10_QPR_GRAFICO, echo=FALSE}
# Grafico del top 10

top_10_plot <- top_10_qpr %>%
  # USAMOS COMILLAS INVERTIDAS (` `) para llamar a la columna
  arrange(`Relación QPR (Puntos/1k USD)`) %>% 
  
  # columna de etiqueta combinada
  mutate(Label = factor(paste(Fabricante, Modelo), 
                        levels = paste(Fabricante, Modelo)))

# gráfico de barras
grafico_qpr <- ggplot(top_10_plot, aes(x = Label, y = `Relación QPR (Puntos/1k USD)`, fill = Motorización)) +
  geom_bar(stat = "identity", color = "black", width = 0.7) +
  
  # etiquetas de valor
  geom_text(aes(label = sprintf("%.2f", `Relación QPR (Puntos/1k USD)`)), 
            hjust = -0.1, size = 3.5, fontface = "bold") +
  
  # estética y etiquetas
  labs(title = "Top 10: Análisis Comparativo de la Relación Calidad-Precio (QPR)",
       subtitle = "Puntos de Calidad por cada $1000 USD (Mercado Global 2025)",
       x = "Vehículo (Fabricante y Modelo)",
       y = "Relación Calidad-Precio (QPR)") +
  
  # Invertir coordenadas para un gráfico más legible
  coord_flip() +
  
  # colores y el tema del grafico
  scale_fill_manual(values = c("Petrol" = "#FFD700", "Hybrid" = "#1E90FF", "Diesel" = "#A9A9A9", "plug in hyrbrid" = "#00BFFF")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0, size = 12),
    axis.text.y = element_text(size = 10, face = "bold"),
    axis.title.x = element_text(margin = margin(t = 10)),
    legend.position = "bottom"
  )

# el gráfico
print(grafico_qpr)

```


# COMPARATIVA POR MARCAS

Bloque de Comparativa y Promedios por Marca

Este bloque calcula el QPR promedio, el precio promedio y el número de modelos por cada fabricante, y selecciona las 10 marcas con mejor QPR.

```{r brand_comparison, echo=FALSE}
# Agrupamos los datos por Fabricante y calculamos los promedios
brand_qpr_summary <- data_qpr %>%
  group_by(Company.Names) %>%
  summarise(
    Modelos = n(),
    QPR_Promedio = mean(QPR, na.rm = TRUE),
    Precio_Promedio_USD = mean(Price_Avg, na.rm = TRUE)
  ) %>%
  # Filtramos solo las marcas con más de un modelo para un análisis robusto
  filter(Modelos >= 2) %>%
  # Ordenamos por el QPR Promedio de forma descendente
  arrange(desc(QPR_Promedio)) %>%
  head(10) %>%
  rename(Fabricante = Company.Names)

# Mostramos la tabla resumen de las 10 mejores marcas
print(brand_qpr_summary)


# Gráfico de QPR Promedio por Marca

```

```{r plot_brand_qpr, echo=FALSE}
# Preparamos los datos para el gráfico, ordenando las marcas para la visualización
brand_plot <- brand_qpr_summary %>%
  arrange(QPR_Promedio) %>%
  mutate(Fabricante = factor(Fabricante, levels = Fabricante))

# Generación del gráfico de barras horizontal
grafico_marcas <- ggplot(brand_plot, aes(x = Fabricante, y = QPR_Promedio)) +
  geom_bar(stat = "identity", fill = "#1E90FF", color = "black", width = 0.7) +
  
  # Añadir etiquetas de valor
  geom_text(aes(label = sprintf("%.2f", QPR_Promedio)), 
            hjust = -0.1, size = 4, fontface = "bold") +
  
  # Mejorar la estética y etiquetas
  labs(title = "Top 10: Relación Calidad-Precio Promedio por Marca",
       subtitle = "Basado en el QPR promedio de todos sus modelos (solo marcas con >= 2 modelos)",
       x = "Fabricante",
       y = "QPR Promedio (Puntos/1k USD)") +
  
  # Invertir coordenadas para un gráfico de barras horizontal más legible
  coord_flip() +
  
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0, size = 12),
    axis.text.y = element_text(size = 10, face = "bold"),
    axis.title.x = element_text(margin = margin(t = 10))
  )

# Mostrar el gráfico
print(grafico_marcas)
```



#ANALISIS POR COMBUSTIBLE



#CONCLUSIONES Y RECOMENDACIONES